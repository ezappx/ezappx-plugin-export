/*! ezapp-plugin-export - 0.0.28 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],t):"object"==typeof exports?exports["ezapp-plugin-export"]=t(require("grapesjs")):e["ezapp-plugin-export"]=t(e.grapesjs)}(window,function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(0),r=(o=a)&&o.__esModule?o:{default:o};t.default=r.default.plugins.add("ezapp-plugin-export",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getConfig().stylePrefix,o=document.createElement("BUTTON");o.innerHTML="导出",o.className=n+"btn-prim",e.Commands.add("ezapp-export",{run:function(){var n='<!doctype html><html lang="en"><head><meta charset="utf-8"><link rel="stylesheet" href="./css/style.css">',o="</head><body>",a="</body><html>",r='<link href="',s='" rel="stylesheet">',i='<script src="',c='"><\/script>',u=t.username,l=t.projectName,p=e.getDevice(),f=n,d=[];$.each(e.getConfig().canvas.styles,function(e,t){f=f+r+t+s}),$.each(e.getConfig().canvas.scripts,function(e,t){f=f+i+t+c});var y={username:u,projectName:l,mobileOS:p,filePath:"./index.html",content:f=f+o+e.getHtml()+a};$.ajax({type:"POST",url:"/export/upload/projectFile",data:JSON.stringify(y),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(e){console.log(e),""!=e.fileId&&d.push(e.fileId)},failure:function(e){alert(data.status)}});var g={username:u,projectName:l,mobileOS:p,filePath:"./css/style.css",content:e.getCss()};$.ajax({type:"POST",url:"/export/upload/projectFile",data:JSON.stringify(g),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(e){console.log(e),""!=e.fileId&&d.push(e.fileId)},failure:function(e){alert(data.status)}});var m=new Date($.now()),j={username:u,projectName:l,createdAt:m,updatedAt:m,mobileOS:p,binaryFiles:d,cordovaPlugins:[]};console.log(j),console.log(JSON.stringify(j)),$.ajax({type:"POST",url:"/export/sendBuildRequest",data:JSON.stringify(j),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(e){alert(e.status)},failure:function(e){alert(data.status)}})}}),e.on("run:export-template",function(){e.Modal.getContentEl().appendChild(o),o.onclick=function(){e.runCommand("ezapp-export")}})})}])});
//# sourceMappingURL=ezapp-plugin-export.min.js.map