/*! ezapp-plugin-export - 0.0.33 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],t):"object"==typeof exports?exports["ezapp-plugin-export"]=t(require("grapesjs")):e["ezapp-plugin-export"]=t(e.grapesjs)}(window,function(e){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(0),r=(o=a)&&o.__esModule?o:{default:o};t.default=r.default.plugins.add("ezapp-plugin-export",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.getConfig().stylePrefix,o=document.createElement("BUTTON");o.innerHTML="导出",o.className=n+"btn-prim",e.Commands.add("ezapp-export",{run:function(){var n='<!doctype html><html lang="en"><head><meta charset="utf-8"><link rel="stylesheet" href="./css/style.css">',o="</head><body>",a="</body><html>",r='<link href="',s='" rel="stylesheet">',i='<script src="',c='"><\/script>',l=t.username,u=t.projectName,p=e.getDevice(),f=n,d=t.uploadApi,y=t.exportApi,g=[];$.each(e.getConfig().canvas.styles,function(e,t){f=f+r+t+s}),$.each(e.getConfig().canvas.scripts,function(e,t){f=f+i+t+c});var m={username:l,projectName:u,mobileOS:p,filePath:"./index.html",content:f=f+o+e.getHtml()+a};$.ajax({type:"POST",url:d,data:JSON.stringify(m),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(e){console.log(e),""!=e.fileId&&g.push(e.fileId)},failure:function(e){alert(data.status)}});var h={username:l,projectName:u,mobileOS:p,filePath:"./css/style.css",content:e.getCss()};$.ajax({type:"POST",url:d,data:JSON.stringify(h),contentType:"application/json; charset=utf-8",dataType:"json",async:!1,success:function(e){console.log(e),""!=e.fileId&&g.push(e.fileId)},failure:function(e){alert(data.status)}});var j=new Date($.now()),x={username:l,projectName:u,createdAt:j,updatedAt:j,mobileOS:p,binaryFiles:g,cordovaPlugins:[]};console.log(x),console.log(JSON.stringify(x)),$.ajax({type:"POST",url:y,data:JSON.stringify(x),contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(e){console.log(e),""!=e.downloadUrl&&(window.location.href=e.downloadUrl,alert(e.status))},failure:function(e){alert(data.status)}})}}),e.on("run:export-template",function(){e.Modal.getContentEl().appendChild(o),o.onclick=function(){e.runCommand("ezapp-export")}})})}])});
//# sourceMappingURL=ezapp-plugin-export.min.js.map